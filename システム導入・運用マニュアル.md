# システム導入・運用マニュアル

## 1. はじめに
本資料は、ピラティススタジオLP（ランディングページ）のシステム導入および運用方法について解説したものです。
本LPは**静的HTML**で構成されており、お問い合わせフォーム機能には**Google Apps Script (GAS)** を利用しています。サーバー費用の負担なく、低コストで運用できるのが特徴です。

## 2. 納品ファイル構成
納品フォルダ（`LP_ピラティス`）の主な構成は以下の通りです。

| ファイル名 | 役割 |
|Info|Explanation|
|---|---|
| `index.html` | LPのトップページ（すべての内容がここに記述されています） |
| `style.css` | デザイン・レイアウトを装飾するスタイルシート |
| `script.js` | フォーム送信機能やハンバーガーメニューの動作を制御するスクリプト |
| `images/` | 画像ファイルが格納されているフォルダ（※実際の納品時は画像フォルダをご参照ください） |

---

## 3. 導入手順（お申し込みフォーム設定）

お問い合わせフォームを稼働させるために、Google Apps Script（GAS）の設定が必要です。
以下の手順に従って設定を行ってください。

### 手順1: Googleスプレッドシートの作成
1. Googleドライブを開き、「新規」>「Google スプレッドシート」を作成します。
2. スプレッドシートの名前を「**問い合わせ管理**」など、わかりやすい名前に変更します。
3. 機能拡張（Extensions） > **Apps Script** をクリックします。

### 手順2: GASコードの記述
エディタが開いたら、最初に入っているコード（`function myFunction...`）をすべて削除し、**以下のコードをコピー＆ペースト**してください。

```javascript
// --- ここからコピー ---
function doPost(e) {
  try {
    // フォームからのデータ取得
    var params = e.parameter;
    var name = params.name;
    var email = params.email;
    var date1 = params.date1;
    var date2 = params.date2;
    var message = params.message;

    // 1. 管理者への通知メール
    // ★以下のメールアドレスをご自身のものに変更してください★
    var adminEmail = "YOUR_EMAIL@gmail.com"; 
    var adminSubject = "【体験予約】新しいお申し込みがありました";
    var adminBody = "LPより新しいお申し込みがありました。\n\n" +
                    "お名前: " + name + "\n" +
                    "Email: " + email + "\n" +
                    "第1希望: " + date1 + "\n" +
                    "第2希望: " + date2 + "\n" +
                    "\nメッセージ:\n" + message;
    
    MailApp.sendEmail(adminEmail, adminSubject, adminBody);

    // 2. お客様への自動返信メール
    var userSubject = "【自動返信】体験レッスンのお申し込みありがとうございます";
    var userBody = name + " 様\n\n" +
                   "この度は体験レッスンにお申し込みいただき、誠にありがとうございます。\n" +
                   "以下の内容で承りました。\n\n" +
                   "--------------------------------\n" +
                   "■お名前: " + name + "\n" +
                   "■第1希望日時: " + date1 + "\n" +
                   "■第2希望日時: " + date2 + "\n" +
                   "--------------------------------\n\n" +
                   "日程を確認の上、担当者（" + adminEmail + "）より\n" +
                   "改めてご連絡させていただきます。\n" +
                   "今しばらくお待ちくださいませ。";
                   
    MailApp.sendEmail(email, userSubject, userBody);

    // 成功レスポンス
    return ContentService.createTextOutput(JSON.stringify({result: 'success'}))
      .setMimeType(ContentService.MimeType.JSON);

  } catch(error) {
    // エラーレスポンス
    return ContentService.createTextOutput(JSON.stringify({result: 'error', error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
// --- ここまでコピー ---
```

> [!IMPORTANT]
> コード内の `var adminEmail = "YOUR_EMAIL@gmail.com";` の部分は、必ず**ご自身の通知を受け取りたいメールアドレス**に書き換えてください。

### 手順3: デプロイ（公開設定）
スクリプトをWebアプリとして公開します。

1. 画面右上の **「デプロイ」** > **「新しいデプロイ」** をクリック。
2. 「種類の選択」の歯車アイコン > **「ウェブアプリ」** を選択。
3. 以下の通り設定します。
    *   説明: 「フォーム送信」など（適当でOK）
    *   次のユーザーとして実行: **自分（Me）**
    *   アクセスできるユーザー: **全員（Anyone）** ← **※重要！**
4. **「デプロイ」** ボタンをクリック。
5. （初回のみ）「アクセスを承認」が求められます。
    *   自分のGoogleアカウントを選択 > 「詳細（Advanced）」 > 「安全ではないページに移動」 > 「許可（Allow）」と進んでください。
6. **ウェブアプリ URL** が発行されます。このURL（`https://script.google.com/...`）をコピーしてください。

### 手順4: `script.js` にURLを設定
1. 納品フォルダ内の `script.js` をテキストエディタで開きます。
2. 44行目付近にある `GOOGLE_FORM_URL` の値を、先ほどコピーしたURLに書き換えてください。

```javascript
// ↓↓↓ここにGASのWebアプリURLを貼り付けてください↓↓↓
const GOOGLE_FORM_URL = 'https://script.google.com/macros/s/xxxxxxxxxxxxx/exec';
```
3. 上書き保存して完了です。

---

## 4. 運用・更新方法

### テキストの修正
文章を変更したい場合は、`index.html` を編集します。
- `<h2>...</h2>` や `<p>...</p>` の中の文字を書き換えるだけで反映されます。
- `<br>` は改行を意味します。

### 画像の差し替え
画像を入れ替えたい場合は、`images` フォルダ内の画像を新しい画像（同じファイル名）で上書きするか、`index.html` 内の `src="画像パス"` を変更してください。

### 予約の確認
お申し込みがあると、**導入手順2**で設定したメールアドレスに通知が届きます。
お客様には自動返信メールが送られますので、その後は個別にメールで日程調整の連絡を行ってください。

---

## 5. よくあるトラブル

**Q. 送信ボタンを押しても「エラー」になる**
A. GASのデプロイ設定で「アクセスできるユーザー」が「全員」になっているか確認してください。「自分のみ」だと動きません。設定を変更した場合は、必ず**「新しいデプロイ」**（バージョンを更新）を行う必要があります。

**Q. メールが届かない**
A. 迷惑メールフォルダに入っていないか確認してください。また、GASコード内のメールアドレスが正しいか確認してください。
